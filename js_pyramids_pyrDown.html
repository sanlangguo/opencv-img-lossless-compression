<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Image PyrDown Example</title>
    <link href="js_example_style.css" rel="stylesheet" type="text/css" />
    <style>
        #canvasInput,
        #canvasOutput {
            width: 400px;
            height: 400px;
        }
    </style>
</head>

<body>
    <p class="err" id="errorMessage"></p>
    </div>
    <div>
        <table cellpadding="0" cellspacing="0" width="0" border="0">
            <tr>
                <td>
                    <canvas id="canvasInput"></canvas>
                </td>
                <td>
                    <canvas id="canvasOutput"></canvas>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="caption">canvasInput <input type="file" id="fileInput" name="file" accept="image/*" />
                    </div>
                </td>
                <td>
                    <div class="caption">展示</div>
                </td>
            </tr>
        </table>
    </div>
    <script src="opencv.js" type="text/javascript"></script>
    <script src="utils.js" type="text/javascript"></script>
    <script type="text/javascript">
        let utils = new Utils('errorMessage');

        utils.addFileInputHandler('fileInput', 'canvasInput', () => {
            setTimeout(() => {
                let src = cv.imread('canvasInput');
                let dst = new cv.Mat();
                const dsize = new cv.Size(0, 0)
                console.log('Size: ', dsize)
                // cv.pyrDown(src, dst, dsize, cv.BORDER_DEFAULT);
                cv.resize(src, dst, dsize, .6, 0.6, 0);
                cv.imshow('canvasOutput', dst);
                // src.delete(); dst.delete();
                // setTimeout(() => {
                //     debugger
                //     let src2 = cv.imread('canvasOutput');
                //     let dst2 = new cv.Mat();
                //     const dsize2 = new cv.Size(0, 0)
                //     cv.pyrDown(src2, dst2, dsize2, cv.BORDER_DEFAULT);
                //     cv.imshow('canvasOutput', dst2);
                //     src.delete(); dst.delete();
                //     src2.delete(); dst2.delete();
                // }, 100)
            }, 100)
        });
    </script>
</body>

</html>